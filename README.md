# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

### Данные и типы данных, используемые в приложении

Карточка товара

```
interface ICardProduct {
        id: string;
        title: string;
        category: string;
        description: string;
        image: string;
        price: number | null;
        index: number;
}
```

Интерфейс заказа

```
interface IOrder {
        address: string;
        payment: string;
        email: string;
        phone: string;
        total: number;
        items: string[];
}
```

Интерфейс состояния приложения

```
interface IAppData {
        catalog: ICardProduct[];
        order: IOrder | null;
        basket: ICardProduct[] | null;
}
```

Интерфейс заказа

```
interface IOrder {
        address: string;
        payment: string;
        email: string;
        phone: string;
        total: number;
        items: string[];
}
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:

- слой представления, отвечает за отображение данных на странице,
- слой данных, отвечает за хранение и изменение данных
- презентер(событийно оринтированный подход), отвечает за связь представления и данных.

Основной принцип - событийно-ориентированная архитектура, где компоненты общаются через централизованную систему событий.

## Событийно-ориентированный подход

Главный файл `index.ts` приложения организует взаимодействие всех компонентов через систему событий:

1. **Основные события**:

   - `catalog:changed` - обновление каталога товаров
   - `card:select` - выбор товара
   - `card:add/card:delete` - управление корзиной
   - `basket:open` - открытие корзины
   - `order:open/order:submit` - оформление заказа
   - `contacts:submit` - завершение заказа
   - `modal:open/modal:close` - управление модальными окнами

2. **Поток данных**:
   - При загрузке страницы загружается каталог товаров
   - Пользователь взаимодействует с интерфейсом → генерируются события
   - Компоненты реагируют на события, изменяя состояние (AppState)
   - AppState генерирует события изменений
   - UI компоненты обновляются в ответ на изменения состояния

**Преимущества подхода**:

- Слабая связанность компонентов
- Централизованное управление состоянием
- Легкость добавления новой функциональности
- Прозрачность потока данных

Такая архитектура обеспечивает гибкость, масштабируемость и удобство поддержки приложения.

## Базовые классы

### 1. `Api` / Базовый класс для работы с API

Обеспечивает взаимодействие с бэкендом.

**Основные методы**:

- `get` - GET-запрос
- `post` - POST/PUT/DELETE запросы
- `handleResponse` - обработка ответа сервера

### 2. `EventEmitter` / Брокер событий

Класс управления событиями приложения.

**Основные методы**:

- `on` - подписка на событие
- `off` - отписка от события
- `emit` - генерация события

### 3. `Component` / Базовый компонент UI

Базовый класс для всех UI-компонентов.

- Принимает контейнер DOM-элемента
- Имеет общие методы для работы с DOM
- Показа/скрытия элементов
- Базовый метод render для обновления состояния

**Основные методы**:

- `toggleClass` - переключение CSS-класса
- `setText` - установка текстового содержимого
- `setDisabled` - управление состоянием disabled
- `setHidden/setVisible` - управление видимостью
- `setImage` - установка изображения
- `render` - основной метод рендеринга

### 4. `Model` / Базовая модель данных

Базовый класс для моделей данных.

`Работает в паре с EventEmitter`.

**Основные методы**:

- `emitChanges` - уведомление об изменениях модели
- Использует Object.assign для инициализации свойств

## Базовые компоненты

### `Form` / Базовая форма

Базовый класс для всех форм.

- Обработка ввода данных
- Валидация
- Управление состоянием кнопки submit

### `Modal` / Модальное окно

Управление модальными окнами.

- Открытие/закрытие
- Отображение контента

**Основные методы**:

- `open`/`close` - управление видимостью
- Блокировка прокрутки страницы при открытии

### `Page` / Главная страница

Управление основным отображением приложения.

**Функционал**:

- Отображение каталога товаров
- Управление счетчиком корзины
- Блокировка страницы при открытых модальных окнах
- Обработка кликов по корзине

### `Success` / Успешное оформление

Отображение успешного завершения заказа.

- Показывает итоговую сумму
- Кнопка закрытия модального окна

### `WebLarekAPI` / API для работы с сервером

Класс для работы с API магазина.

**Класс включает:**

- Получение списка товаров
- Оформление заказа

**Основные методы**:

- `getProductsList` - получение списка товаров
- `orderProduct` - оформление заказа

## Слой данных

### `AppState` / Модель состояния приложения

Реализует состояния приложения.

**Основные поля:**

- `catalog` - каталог товаров
- `order` - данные текущего заказа
- `formErrors` - ошибки валидации форм

**Модель включает:**

- Бизнес-логику валидации
- Методы работы с корзиной

**Основные методы**:

- `setCatalog()` - загрузка каталога товаров
- `addToOrder()/removeFromOrder()` - управление корзиной
- `validateOrder()` - валидация данных заказа
- `clearBasket()` - очистка корзины
- `setOrderField()` - установка значения поля заказа

## Компоненты UI

### `Card` / Компонент карточки товара

- Отображение товара в разных вариантах:
  - В каталоге
  - В превью
  - В корзине
- Поддержка разных состояний (выбрано/не выбрано)

### `Basket` / Компонент корзины

- Отображение и управление корзиной покупок:
  - Список товаров
  - Итоговая сумма
  - Кнопка оформления заказа
- Управление состоянием кнопки (активна/неактивна)

### `Order` / Компонент формы заказа

- Выбор способа оплаты
- Ввод адреса доставки
- Валидация данных
- Управление состоянием кнопок оплаты
- Очистка заданных значений полей формы

### `Contacts` / Компонент формы контактные данные

- Управление полями phone и email
- Валидация данных
- Очистка заданных значений полей формы
